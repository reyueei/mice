var fnNameSpace="fntoolbar";if(typeof window[fnNameSpace]=="undefined"){window[fnNameSpace]={}}window[fnNameSpace].Manager=function(){var c="fn_layer8";var b=1000;var d=5000;var a="fnscreenOverlay";var e=new Object();this.toolbarsById=e;this.toolbarsZIndex=99999;this.swipeHandler;this.toolbarData;this.currentToolbar;this.isRestorePreviousViewportNeeded=false;this.initialToolbarBindingIntervalMethod=false;this.lastNotifiedOrientation;this.tbstatus={};this.flashPlayerManager=undefined;this.enableFlashPlayerManager=true;this.updateScrollTimerId=0;this.initManager=function(){try{this.initGlobals();this.calculateMaxZIndex();this.isMobileAwareSite=window[fnNameSpace].ViewPort.isMobileAwareSite();this.lastNotifiedOrientation=window[fnNameSpace].displayUtils.isPortrait();window[fnNameSpace].message.assignTo(this);this.initToolbarData();var g=this.loadToolbar(c,"portrait");if(g===false){throw"No toolbars found"}this.appendScreenOverlayLayout(a);if(typeof window[fnNameSpace].OverlayTextBox!=="undefined"){window[fnNameSpace].OverlayTextBox.appendScreenOverlayTextBoxLayout()}this.initManagerDevice();this.setCurrentToolbar(e[c]);if(!this.currentToolbar){throw"No toolbar is set!"}window[fnNameSpace].EventRegister(this.eventsToRegister);if(this.enableFlashPlayerManager){this.flashPlayerManager=new window[fnNameSpace].FlashPlayerManager();this.flashPlayerManager.modifyFlashPlayerWmode()}this.notifyManagerIsUp();this.setToolbarLocationAfterPageLoad()}catch(f){return false}};this.initGlobals=function(){this.initGetComputedStyleIfNeeded()};this.initGetComputedStyleIfNeeded=function(){if(!window.getComputedStyle){window.getComputedStyle=function(f,g){this.el=f;this.getPropertyValue=function(i){var h=/(\-([a-z]){1})/g;if(i=="float"){i="styleFloat"}if(h.test(i)){i=i.replace(h,function(){return arguments[2].toUpperCase()})}return f.currentStyle[i]?f.currentStyle[i]:null};return this}}};this.scrollToDest=function(f,g){if(g=="bottom"){g=document.body.scrollHeight}window.scrollTo(f,g)};this.setPageOpcityTrick=function(){document.body.style.opacity=0.999;window.setTimeout(function(){document.body.style.opacity=1;document.body.style.opacity=""},1)};this.setToolbarLocationAfterPageLoad=function(){if(b<=0){return}this.initialToolbarBindingIntervalMethod=new window[fnNameSpace].StopWatch();this.initialToolbarBindingIntervalMethod.create(function(){if(typeof manager.currentToolbar.move=="function"){setTimeout(function(){manager.currentToolbar.move()},0)}},b,"Fix toolbar location on page load");var f=new window[fnNameSpace].StopWatch();f.create(function(){manager.initialToolbarBindingIntervalMethod.remove()},d,"Remove toolbar location fix timer",true)};this.calculateMaxZIndex=function(){this.maxZIndexOnPage=window[fnNameSpace].domHelper.getMaxZIndex();this.toolbarsZIndex=(this.maxZIndexOnPage>this.toolbarsZIndex)?this.maxZIndexOnPage+1:this.toolbarsZIndex};this.appendScreenOverlayLayout=function(h){var g=document.createElement("div");g.setAttribute("id",h);window[fnNameSpace].util.setStyleWithImportant(g,"background-color","transparent",true);if(window[fnNameSpace].util.Browser.isAndroid23){window[fnNameSpace].util.setStyleWithImportant(g,"position","absolute",true);window[fnNameSpace].util.setStyleWithImportant(g,"top",window.scrollY+"px",true);window[fnNameSpace].util.setStyleWithImportant(g,"left",window.scrollX+"px",true);window[fnNameSpace].util.setStyleWithImportant(g,"right","auto",true);window[fnNameSpace].util.setStyleWithImportant(g,"bottom","auto",true);window[fnNameSpace].util.setStyleWithImportant(g,"height","1000%",true)}else{window[fnNameSpace].util.setStyleWithImportant(g,"position","fixed",true);window[fnNameSpace].util.setStyleWithImportant(g,"bottom","0px",true);window[fnNameSpace].util.setStyleWithImportant(g,"left","0px",true);window[fnNameSpace].util.setStyleWithImportant(g,"top","auto",true);window[fnNameSpace].util.setStyleWithImportant(g,"right","auto",true);window[fnNameSpace].util.setStyleWithImportant(g,"height",document.documentElement.scrollHeight+"px",true)}var f=window[fnNameSpace].domHelper.getMaxZIndex()-1;f=(window[fnNameSpace].domHelper.getMaxZIndex()-1>99998)?f:99998;window[fnNameSpace].util.setStyleWithImportant(g,"z-index",f,true);window[fnNameSpace].util.setStyleWithImportant(g,"width","100%",true);window[fnNameSpace].util.setStyleWithImportant(g,"text-align","center",true);window[fnNameSpace].util.setStyleWithImportant(g,"margin","0",true);window[fnNameSpace].util.setStyleWithImportant(g,"padding","0",true);window[fnNameSpace].util.setStyleWithImportant(g,"border","0",true);window[fnNameSpace].util.setStyleWithImportant(g,"display","none",true);document.body.appendChild(g);return g};this.setCurrentToolbar=function(f){if(this.currentToolbar){this.currentToolbar.hide(true);this.currentToolbar.isCurrentToolbar=false}this.currentToolbar=f;this.currentToolbar.isCurrentToolbar=true;if(f.isReady){f.loadToolbar();this.currentToolbar.sendCurrentZoomLevelToToolbar()}};this.loadToolbar=function(h,g){if(!window[fnNameSpace].domHelper.checkElementOnPageById(h)){return false}var f=window[fnNameSpace].domHelper.getElement(h);var i=new window[fnNameSpace].Toolbar(f,this.toolbarsZIndex);e[i.id]=i;return true};this.isDebug=function(){if(window[fnNameSpace].util.fetchGetVariableValue("fndebug")=="true"){return true}return false};this.messageAllToolbars=function(g){window[fnNameSpace].util.console("sending message to all toolbars!","messaging");for(var f in e){window[fnNameSpace].util.console("sending message: "+window[fnNameSpace].util.serialize(g)+" to toolbar: "+e[f].id,"messaging");e[f].sendMessage(g)}};this.notifyManagerIsUp=function(){var f=this.getManagerUpMessage();this.messageAllToolbars(f)};this.notifyManagerIsUpToOneFrame=function(f){var g=this.getManagerUpMessage();g.frameAlreadyUp=true;f.sendMessage(g)};this.getManagerUpMessage=function(){var g=new Object();g.message="ManagerUp";g.toolbarData=this.toolbarData;var f=window[fnNameSpace].displayUtils.getVisualViewportInfo();g.windowWidth=f.width;g.windowHeight=f.height;g.screenWidth=screen.width;g.screenHeight=screen.height;g.isPortrait=window[fnNameSpace].displayUtils.isPortrait();g.zoomLevel=window[fnNameSpace].displayUtils.getIframeZoomLevel();g.pageInfo={url:window.location.href,title:window.document.title,icon:window.location.href+"/favicon.ico"};g.doNotQueue=true;g.isMobileAwareSite=manager.isMobileAwareSite;g.iframePositioning=manager.currentToolbar.getIframePositioning();return g};this.initToolbarData=function(){var f;if(window[fnNameSpace].domHelper.checkElementOnPageById(window[fnNameSpace].util.FN_TOOLBAR_SCRIPT)===false){return false}f=document.getElementById(window[fnNameSpace].util.FN_TOOLBAR_SCRIPT).getAttribute(window[fnNameSpace].util.TOOLBAR_DATA_ATTRIBUTE);this.toolbarData=f;if(!f){return false}return true};this.updateAllFramesWithWindowSize=function(){var g=new Object();g.message="ScreenSizeChange";var f=window[fnNameSpace].displayUtils.getVisualViewportInfo();g.windowWidth=f.width;g.windowHeight=f.height;g.screenWidth=screen.width;g.screenHeight=screen.height;this.messageAllToolbars(g)};this.loadToolbarPosition=function(){var f=new Object();f.message="LoadToolbarPosition";this.currentToolbar.sendMessage(f)};this.storeToolbarPosition=function(f,h){var g=new Object();g.message="StoreToolbarPosition";g.verticalPos=f;g.horizontalPos=h;this.currentToolbar.sendMessage(g)};this.attachClassToElement=function(f,g){var h=new Object();h.message="AttachClassToElement";h.elementId=f;h.className=g;this.currentToolbar.sendMessage(h)};this.maximizeToolbarRequest=function(){var f=new Object();f.message="MaximizeToolbarRequest";this.currentToolbar.sendMessage(f)};this.minimizeToolbarRequest=function(){var f=new Object();f.message="MinimizeToolbarRequest";this.currentToolbar.sendMessage(f)};this.sendOverlayTextBoxValue=function(g,f){var h=new Object();h.message="SendOverlayTextBoxValue";h.elementId=g;h.textValue=encodeURI(f);this.currentToolbar.sendMessage(h)};this.notifyOverlayTextBoxSubmit=function(f){var g=new Object();g.message="NotifyOverlayTextBoxSubmit";g.submitString=f;this.currentToolbar.sendMessage(g)};this.notifyOverlayTextBoxClose=function(f){var g=new Object();g.message="NotifyOverlayTextBoxClose";g.closeString=f;this.currentToolbar.sendMessage(g)};this.onInitializeDragDropManager=function(f){if(typeof window[fnNameSpace].DragDropManager==="undefined"){window[fnNameSpace].util.console("DragDropManager is undefined","DragDrop");return}if(e[f.sender]){if(window[fnNameSpace].dragdropManager!=null){return}var g=f.params||{};window[fnNameSpace].dragdropManager=new window[fnNameSpace].DragDropManager(g);window[fnNameSpace].dragdropManager.registerDragSupport()}};this.onSuspendDragDrop=function(f){if(e[f.sender]){if(window[fnNameSpace].dragdropManager){window[fnNameSpace].dragdropManager.suspendDragDrop(f.bSuspend)}}};this.onToolbarSetDragPosition=function(f){if(e[f.sender]){if(window[fnNameSpace].dragdropManager&&!window[fnNameSpace].dragdropManager.isSuspend()){window[fnNameSpace].dragdropManager.setPosition(f.verticalPos,f.horizontalPos)}}};this.onSetDragIcon=function(f){if(e[f.sender]){if(window[fnNameSpace].dragdropManager){window[fnNameSpace].dragdropManager.setDragIcon(f.iconUrl)}}};this.onToolbarNotifyStateChange=function(f){if(e[f.sender]){if(window[fnNameSpace].dragdropManager){window[fnNameSpace].dragdropManager.toolbarStateChanged(f.params.state)}}};this.onFrameUp=function(f){var g=e[f.sender];if(!g){return}if(!f.managerUp){this.notifyManagerIsUpToOneFrame(g);return}g.onFrameReady();if(g.isCurrentToolbar){g.loadToolbar(f.config);g.sendCurrentZoomLevelToToolbar()}};this.onRequestPageNavigation=function(f){window.location.href=f.url};this.onUpdateToolbarStatus=function(f){manager.tbstatus.isMinimize=f.isMinimize};this.onToolbarResize=function(f){if(e[f.sender]){e[f.sender].resize(f.width,f.height,true,f.ratio)}};this.onToolbarScrollToDest=function(f){if(e[f.sender]){manager.scrollToDest(f.x,f.y)}};this.onToolbarOpacityRenderTrick=function(f){if(e[f.sender]){manager.setPageOpcityTrick()}};this.onToolbarMove=function(f){if(e[f.sender]){e[f.sender].move(f.positioning)}};this.onShowToolbar=function(f){if(e[f.sender]){e[f.sender].show();e[f.sender].sendCurrentZoomLevelToToolbar();manager.currentToolbar.showL8CompletedCallback()}};this.onHideToolbar=function(f){if(e[f.sender]){e[f.sender].hide()}};this.onChangeIframePosition=function(f){if(e[f.sender]){manager.toolbarPositionControl(f)}};this.onChangeIframeOpacity=function(f){if(e[f.sender]){manager.toolbarOpacityControl(f)}};this.onSetScreenOverlay=function(f){if(e[f.sender]){manager.toolbarScreenOverlay(f.screenOverlayId,f)}};this.onShowOverlayTextBox=function(f){if(e[f.sender]){if(typeof window[fnNameSpace].OverlayTextBox!=="undefined"){window[fnNameSpace].OverlayTextBox.showOverlayTextBox(f)}}}};window[fnNameSpace].Manager.prototype.handleOrientationChange=function(a){manager.firstOrientationChangeOccur=true;var c=window[fnNameSpace].displayUtils.isPortrait();if(this.lastNotifiedOrientation!=c){this.handleOrientationChangeDevice();window[fnNameSpace].domHelper.hideiFrameWithOpacity(0.2);this.lastNotifiedOrientation=c;var b=this;window.setTimeout(function(){b.currentToolbar.sendCurrentZoomLevelToToolbar();b.currentToolbar.resize();b.currentToolbar.onOrientationChange(c);if(window[fnNameSpace].dragdropManager){window[fnNameSpace].dragdropManager.orientationChange(c)}if(!b.currentToolbar.changeIframeCSSPosition()){window[fnNameSpace].domHelper.showiFrameWithOpacity(0.6)}},500)}return};window[fnNameSpace].Manager.prototype.handleOrientationChangeDevice=function(){};window[fnNameSpace].Manager.prototype.triggerUpdateScrollEventTimer=function(){if(this.updateScrollTimerId===0){this.updateScrollTimerId=window.setTimeout(function(){var a=new Object();a.message="PageScroll";a.scrollTop=document.body.scrollTop;a.scrollHeight=document.body.scrollHeight;a.scrollWidth=document.body.scrollWidth;manager.currentToolbar.sendMessage(a);manager.updateScrollTimerId=0},2000)}};window[fnNameSpace].Manager.prototype.handleScroll=function(a){};window[fnNameSpace].Manager.prototype.lastVisualViewportInfo=undefined;window[fnNameSpace].Manager.prototype.handleResize=function(a){var d=this;setTimeout(function(){var e=window[fnNameSpace].displayUtils.getVisualViewportInfo();if(window[fnNameSpace].OverlayTextBox&&window[fnNameSpace].OverlayTextBox.isDisplayed()){if(d.lastNotifiedOrientation===window[fnNameSpace].displayUtils.isPortrait()){if(d.lastVisualViewportInfo&&(d.lastVisualViewportInfo.width===e.width)&&((d.lastVisualViewportInfo.height<e.height))){window[fnNameSpace].OverlayTextBox._restoreLayer8()}}}d.lastVisualViewportInfo=e},0);if(typeof window[fnNameSpace].Manager.prototype.toolbarScreenOverlayVisible==="object"){var c=(window[fnNameSpace].displayUtils.getIframeZoomLevel())/100;for(var b in window[fnNameSpace].Manager.prototype.toolbarScreenOverlayVisible){overlayLayout=document.getElementById(b);if(overlayLayout){if(window[fnNameSpace].util.Browser.isAndroid23){window[fnNameSpace].util.setStyleWithImportant(overlayLayout,"height","1000%",true)}else{window[fnNameSpace].util.setStyleWithImportant(overlayLayout,"height",window.screen.height*c+"px",true)}}}}this.handleOrientationChange();var d=this;setTimeout(function(){d.currentToolbar.sendCurrentZoomLevelToToolbar();d.currentToolbar.resize();d.updateAllFramesWithWindowSize();d.currentToolbar.changeIframeCSSPosition()},500)};window[fnNameSpace].Manager.prototype.initManagerDevice=function(){};window[fnNameSpace].Manager.prototype.eventsToRegister=[{event:"beforeunload",func:function(a){window[fnNameSpace].uiEventHandler.beforeunloadEvent(a)},element:document,capture:false},{event:"click",func:function(a){window[fnNameSpace].mouseEventsHandler.clickEvent(a)},element:document,capture:false},{event:"mouseup",func:function(a){window[fnNameSpace].mouseEventsHandler.mouseupEvent(a)},element:document,capture:false},{event:"mouseover",func:function(a){window[fnNameSpace].mouseEventsHandler.mouseoverEvent(a)},element:document,capture:false},{event:"mouseout",func:function(a){window[fnNameSpace].mouseEventsHandler.mouseoutEvent(a)},element:document,capture:false},{event:"mousedown",func:function(a){window[fnNameSpace].mouseEventsHandler.mousedownEvent(a)},element:document,capture:false},{event:"scroll",func:function(a){window[fnNameSpace].uiEventHandler.scrollEvent(a)},element:document,capture:false},{event:"resize",func:function(a){window[fnNameSpace].uiEventHandler.resizeEvent(a)},element:window,capture:false},{event:"orientationchange",func:function(a){window[fnNameSpace].uiEventHandler.orientationChangeEvent(a)},element:window,capture:false}];window[fnNameSpace].Manager.prototype.handleScroll=function(a){if(!this.currentToolbar){return}if(!this.currentToolbar.isVisible){return}this.currentToolbar.move();this.triggerUpdateScrollEventTimer();this.updateAllFramesWithWindowSize()};window[fnNameSpace].EventRegister=function(a){for(var b in a){window[fnNameSpace].util.addEvent(a[b].event,a[b].func,a[b].capture,a[b].element)}};window[fnNameSpace].MouseEventsHandler=function(){this.clickEvent=function(a){};this.mouseupEvent=function(a){};this.mouseoverEvent=function(a){};this.mouseoutEvent=function(a){};this.mousedownEvent=function(a){}};window[fnNameSpace].mouseEventsHandler=new window[fnNameSpace].MouseEventsHandler();window[fnNameSpace].UiEventHandler=function(){this.beforeunloadEvent=function(a){manager.currentToolbar.hide()};this.loadEvent=function(a){};this.scrollEvent=function(a){if(a.target!==document){return}if((manager.currentToolbar)&&(manager.currentToolbar.stage)){manager.touchCurrentCounter=1;manager.handleScroll(a)}};this.resizeEvent=function(a){manager.handleResize(a);return false};this.orientationChangeEvent=function(a){manager.handleOrientationChange(a)}};window[fnNameSpace].uiEventHandler=new window[fnNameSpace].UiEventHandler();window[fnNameSpace].Manager.prototype.toolbarPositionControl=function(c){var e="";var a="";var d="";var b="";if(c.lr=="left"&&c.tb=="bottom"){a=c.y;d=c.x}else{if(c.lr=="left"&&c.tb=="top"){e=c.y;d=c.x}else{if(c.lr=="right"&&c.tb=="bottom"){a=c.y;b=c.x}else{if(c.lr=="right"&&c.tb=="top"){e=c.y;b=c.x}}}}manager.currentToolbar.setIframePositioning(e,a,d,b)};window[fnNameSpace].Manager.prototype.toolbarOpacityControl=function(c){var a=c.opacity;var d={opacity:a};var b={opacity:a};if(manager.tbstatus.isMinimize){for(var e in b){window[fnNameSpace].util.setStyleWithImportant(manager.currentToolbar.dom,e,b[e],true)}}else{for(var e in d){window[fnNameSpace].util.setStyleWithImportant(manager.currentToolbar.dom,e,d[e],true)}}};window[fnNameSpace].Manager.prototype.toolbarScreenOverlayVisible={};window[fnNameSpace].Manager.prototype.toolbarScreenOverlay=function(h,g){var e=document.getElementById(h);if(!e){return}var d=function(p,n,q){var m,l,j="DXImageTransform.Microsoft.";try{l=p.filters.item(j+n);m=true}catch(o){}if(!m){try{l=p.filters.item(n);m=true}catch(o){}}if(m){l.Enabled=true;if(q){for(var k in q){l[k]=q[k]}}}else{l="";if(q){for(var k in q){l+=k.toLowerCase()+"="+q[k]+","}}if(q){l="("+l.substr(0,l.length-1)+")"}p.style.filter+="progid:"+j+n+l+" "}if(!p.style.zoom){p.style.zoom=1}};var c=g.background;var b=g.opacity;var a="opacity 1s ease";if(g.transition>0){window[fnNameSpace].util.setStyleWithImportant(e,"opacity","0",true);if(document.body.filters){d(e,"Alpha",{Opacity:100})}if(c=="disable"||c==""){window[fnNameSpace].util.setStyleWithImportant(e,"opacity",b,true);if(document.body.filters){d(e,"Alpha",{Opacity:b*100})}}window[fnNameSpace].util.setStyleWithImportant(e,"-webkit-transition","opacity "+g.transition+"s ease",true);window[fnNameSpace].util.setStyleWithImportant(e,"-moz-transition","opacity "+g.transition+"s ease",true);window[fnNameSpace].util.setStyleWithImportant(e,"transition","opacity "+g.transition+"s ease",true)}else{a="";window[fnNameSpace].util.setStyleWithImportant(e,"-webkit-transition","",true);window[fnNameSpace].util.setStyleWithImportant(e,"-moz-transition","",true);window[fnNameSpace].util.setStyleWithImportant(e,"transition","",true)}if(c=="disable"||c==""){window[fnNameSpace].util.setStyleWithImportant(e,"opacity","0",true);if(document.body.filters){d(e,"Alpha",{Opacity:100})}window[fnNameSpace].util.setStyleWithImportant(e,"display","none",true);delete window[fnNameSpace].Manager.prototype.toolbarScreenOverlayVisible[h];return}else{window[fnNameSpace].util.setStyleWithImportant(e,"display","block",true);window[fnNameSpace].util.setStyleWithImportant(e,"background-color","transparent",true);window[fnNameSpace].Manager.prototype.toolbarScreenOverlayVisible[h]=true}var f=(window[fnNameSpace].displayUtils.getIframeZoomLevel())/100;if(!window[fnNameSpace].util.Browser.isAndroid23){window[fnNameSpace].util.setStyleWithImportant(e,"height",window.screen.height*f+"px",true);window[fnNameSpace].util.setStyleWithImportant(e,"top","0px",true);window[fnNameSpace].util.setStyleWithImportant(e,"bottom","auto",true)}else{window[fnNameSpace].util.setStyleWithImportant(e,"height","1000%",true)}window[fnNameSpace].util.setStyleWithImportant(e,"width","100%",true);window[fnNameSpace].util.setStyleWithImportant(e,"opacity",b,true);window[fnNameSpace].util.setStyleWithImportant(e,"background-color",c,true);if(document.body.filters){d(e,"Alpha",{Opacity:b*100})}};window[fnNameSpace].Toolbar=function(a,b){this.isReady=false;this.dom=a;this.queuedMessages=new window[fnNameSpace].Message.MessageQueue();this.isVisible=false;this.config=false;this.id=this.dom.id;this.isFirstLoad=true;this.isCurrentToolbar=false;this.zIndexLevel=(parseInt(b)>0)?b:99999;this.stage;this.initialOpacityReset=false;this.lastOpacity=1;this.init=function(){this.initialOpacityReset=true;window[fnNameSpace].util.setStyleWithImportant(this.dom,"opacity","0",true);this.setStyleDisplay(true);if(this.dom.tagName.toLowerCase()!="iframe"){throw"Expected iframe! got: "+this.dom.tagName}var c=this.dom;window[fnNameSpace].util.thread(function(){if(Number(c.style.zIndex)<=Number(window[fnNameSpace].domHelper.maxZIndexOnPage)){window[fnNameSpace].util.setStyleWithImportant(c,"z-index",parseInt(window[fnNameSpace].domHelper.maxZIndexOnPage),true)}});return true};if(!this.initialToolbarIframe){this.initialToolbarIframe=function(){var e={"z-index":this.zIndexLevel,position:this.config.Position,bottom:this.config.Bottom,right:this.config.Right,top:this.config.Top,left:this.config.Left,padding:this.config.Padding,margin:this.config.Margin,border:this.config.Border,"min-width":"0px","min-height":"0px",background:"transparent"};if(this.config.Opacity!=="undefined"){this.lastOpacity=this.config.Opacity}var c={scrolling:this.config.ATT_Scrolling,frameborder:this.config.ATT_Frameborder,scroll:this.config.ATT_Scroll,allowTransparency:this.config.ATT_Allowtransparency};for(var d in e){window[fnNameSpace].util.setStyleWithImportant(this.dom,d,e[d],true)}for(var d in c){this.dom.setAttribute(d,c[d])}if(this.initialToolbarIframeSpecificDevice){this.initialToolbarIframeSpecificDevice(e,c)}}}this.loadConfiguration=function(c){this.config=c;this.stage=new window[fnNameSpace].StageLogicManager(this);this.changeIframeCSSPosition();this.move(c);return true};this.sendMessage=function(c){c.to=this.id;if((!this.isReady)&&(!c.doNotQueue)){this.queuedMessages.add(c);window[fnNameSpace].util.console("["+this.id+"]Message was added to queue for toolbar "+this.id+" content: "+window[fnNameSpace].util.serialize(c),"messaging")}else{window[fnNameSpace].message.send(c,this.dom);window[fnNameSpace].util.console("["+this.id+"]Message sent to toolbar "+this.id+" content: "+window[fnNameSpace].util.serialize(c),"messaging")}};this.sendQueuedMessages=function(){window[fnNameSpace].util.console("["+this.id+"]sending queued messages","messaging");while(message=this.queuedMessages.shift()){this.sendMessage(message)}};if(!this.setStyleDisplay){this.setStyleDisplay=function(c){window[fnNameSpace].util.setStyleWithImportant(this.dom,"display",c?"block":"none",true);this.isVisible=c}}if(!this.getStylePosition){this.getStylePosition=function(){return this.dom.style.position}}this.hide=function(){if(!this.config){this.delayedShow=false;return}if(this.initialOpacityReset){this.initialOpacityReset=false;window[fnNameSpace].domHelper.showiFrameWithOpacity(0)}if(!this.isVisible){return}this.setStyleDisplay(false);var c=new Object();c.message="ToolbarHide";this.sendMessage(c)};this.show=function(){if(!this.config){this.delayedShow=true;return}if(this.initialOpacityReset){this.initialOpacityReset=false;window[fnNameSpace].domHelper.showiFrameWithOpacity(0.6)}if(!this.isVisible){this.setStyleDisplay(true);this.move()}else{return}var d={};d.message="ToolbarShow";d.isFirstLoad=this.isFirstLoad;var c=window[fnNameSpace].displayUtils.getVisualViewportInfo();d.windowWidth=c.width;d.windowHeight=c.height;this.sendMessage(d);window[fnNameSpace].util.console("["+this.id+"] running show on toolbar "+this.id,"hideAndShow")};if(!(typeof this.move==="function")){this.move=function(c){}}this.resize=function(f,c,d,e){if(!d){d=false}if(this.stage){this.stage.resize(f,c,d,e)}};this.loadToolbar=function(c){var d=this;if(!c){var c=d.config}if(d.isFirstLoad){d.loadConfiguration(c);d.initialToolbarIframe();d.onIframePositioningChange();d.isFirstLoad=false}if(this.delayedShow==true){this.show()}};this.showL8CompletedCallback=function(){var c=new Object();c.message="ShowL8CompletedCallback";this.sendMessage(c)};this.sendCurrentZoomLevelToToolbar=function(){if(!this.isVisible){return}var c=new Object();c.message="ChangeZoom";c.zoom=parseFloat(window[fnNameSpace].displayUtils.getIframeZoomLevel())+"%";c.pageBodyZoomLevel=window[fnNameSpace].displayUtils.getBodyZoomLevel();this.sendMessage(c)};this.updateStageSize=function(d,c){var e=new Object();e.message="UpdateStageSize";e.width=d;e.height=c;this.sendMessage(e)};this.onOrientationChange=function(d){var e=new Object();e.message="OrientationChange";var c=window[fnNameSpace].displayUtils.getVisualViewportInfo();e.isPortrait=d;e.pageHeight=c.height;e.windowWidth=c.width;e.windowHeight=c.height;e.screenWidth=screen.width;e.screenHeight=screen.height;this.sendMessage(e)};this.onFrameReady=function(){this.isReady=true;this.sendQueuedMessages()};if(!this.getIframePositioning){this.getIframePositioning=function(){return{top:this.dom.style.top,bottom:this.dom.style.bottom,left:this.dom.style.left,right:this.dom.style.right}}}if(!this.setIframePositioning){this.setIframePositioning=function(f,c,e,d){window[fnNameSpace].util.setStyleWithImportant(this.dom,"top",f===""?"auto":f,true);window[fnNameSpace].util.setStyleWithImportant(this.dom,"bottom",c===""?"auto":c,true);window[fnNameSpace].util.setStyleWithImportant(this.dom,"left",e===""?"auto":e,true);window[fnNameSpace].util.setStyleWithImportant(this.dom,"right",d===""?"auto":d,true);this.onIframePositioningChange()}}this.onIframePositioningChange=function(){var c={};c.message="IframePositioningChange";c.iframePositioning=this.getIframePositioning();this.sendMessage(c)};this.changeIframeCSSPosition=function(){if((typeof this.config.changeCSSPositionZoomThreshold!=="undefined")&&(this.config.changeCSSPositionZoomThreshold!==0)){var d=window[fnNameSpace].displayUtils.getIframeZoomLevel();var c=this.dom.style.position;if(d<this.config.changeCSSPositionZoomThreshold){if(c==="fixed"){this._setIframeCSSPosition("absolute");this.iframePositionStateChanged=true}}else{if((this.iframePositionStateChanged)&&(c=="absolute")){this._setIframeCSSPosition("fixed");this.iframePositionStateChanged=false}}}return this._handleZoomThreshold()};this._setIframeCSSPosition=function(c){if(window[fnNameSpace].dragdropManager){window[fnNameSpace].dragdropManager.setDragStyle("position",c)}window[fnNameSpace].util.setStyleWithImportant(this.dom,"position",c,true);this.config.Position=c;this.move(this.config)};this.calcAbsolutePosition=function(h){if(this.getStylePosition()!=="absolute"){return{top:h.Top,left:h.Left,bottom:h.Bottom,right:h.Right}}var v=manager.currentToolbar;var q=this.dom.style.display;var s=this.dom.style.visibility;if(q==="none"){window[fnNameSpace].util.setStyleWithImportant(this.dom,"visibility","hidden",true);window[fnNameSpace].util.setStyleWithImportant(this.dom,"display","block",true)}var l;var c;var k=window[fnNameSpace].displayUtils;var r=k.getVisualViewportInfo();var x=r.width;var d=r.height;if(h.Top&&(h.Top==="0px"||h.Top==="0%")){c=0}else{if(h.Bottom&&(h.Bottom==="0px"||h.Bottom==="0%")){c=(d-v.dom.offsetHeight)/d}}if(h.Left&&(h.Left==="0px"||h.Left==="0%")){l=0}else{if(h.Right&&(h.Right==="0px"||h.Right==="0%")){l=(x-v.dom.offsetWidth)/x}else{if((h.Right&&h.Right==="50%")||(h.Left&&h.Left==="50%")||((h.Position&&h.Position==="relative")&&(h.Margin&&h.Margin==="auto"))){l=((x-v.dom.offsetWidth)/x)/2}}}var o=k.getBodyZoomLevel();var j=window.pageYOffset/o;var w=window.pageXOffset/o;var p=0;var m=k.getComputedStyle(document.body,"position");var f=k.getComputedStyle(document.body,"top");if((m&&m!=="static"&&m!=="relative")&&(f)){try{p=parseFloat(f)}catch(u){p=0}}var t=1;var i=1;if(window[fnNameSpace].dragdropManager){t=window[fnNameSpace].dragdropManager.getScreenPosRatio().vertical;i=window[fnNameSpace].dragdropManager.getScreenPosRatio().horizontal}var n=Math.max(j-p+((d)*t*c),0);var g=Math.max(w+((x)*i*l),0);window[fnNameSpace].util.setStyleWithImportant(this.dom,"display",q,true);window[fnNameSpace].util.setStyleWithImportant(this.dom,"visibility",s,true);n=parseInt(n)+"px";g=parseInt(g)+"px";return{top:n,left:g,bottom:"",right:""}};this._handleZoomThreshold=function(){var d=window[fnNameSpace].displayUtils.isPortrait()?this.config.hideZoomThreshold.portrait:this.config.hideZoomThreshold.landscape;if((typeof d==="undefined")||(d===0)){return false}var c=window[fnNameSpace].displayUtils.getIframeZoomLevel();if(c<d){window[fnNameSpace].domHelper.hideiFrameWithOpacity(0.3);return true}else{window[fnNameSpace].domHelper.showiFrameWithOpacity(0.6);return false}};this.init()};window[fnNameSpace].StageLogicManager=function(b){this.parentTB=b;var j=null;var h=null;var i=null;var k=function(l){i=l};var f=function(){if(i===null){var l=window[fnNameSpace].displayUtils.getIFrameDesignDimensions();k(l.width/l.height)}return i};var g=function(m,l){if((typeof m=="undefined")&&(typeof l=="undefined")){return}j=m;h=l};var e=function(){if(!d(j)||!d(h)){return undefined}else{return{width:j,height:h}}};var d=function(l){return window[fnNameSpace].util.validateWidthHeight(l)};var c=function(l,s,u){u=u||1;var v={};if(!d(l)||!d(s)){return undefined}var p=window[fnNameSpace].displayUtils.getVisualViewportInfo();var m=p.width;var q=p.height;var r,n;var o=window[fnNameSpace].util.isNumberPercentageBased(l);var t=window[fnNameSpace].util.isNumberPercentageBased(s);if(o&&t){r=m*parseFloat(l)/100;n=q*parseFloat(s)/100}else{if(o){r=m*parseFloat(l)/100;n=(parseFloat(r)*(1/f()))}else{if(t){n=q*parseFloat(s)/100;r=(parseFloat(n)*f())}else{if(window[fnNameSpace].util.isNumberPixelBased(l)&&window[fnNameSpace].util.isNumberPixelBased(s)){r=(parseFloat(l)*u);n=(parseFloat(s)*u)}}}}v.width=Math.ceil(r)+"px";v.height=Math.ceil(n)+"px";return v};if(!this.changeParentTBSize){this.changeParentTBSize=function(m,l){window[fnNameSpace].util.setStyleWithImportant(this.parentTB.dom,"width",m,true);window[fnNameSpace].util.setStyleWithImportant(this.parentTB.dom,"height",l,true)}}var a=function(p,n,o,r){if(r){k(r)}var q=window[fnNameSpace].displayUtils.getIframeZoomLevel()/100;var m=c(p,n,q);if(!m){var l=e();if(!l){l=window[fnNameSpace].displayUtils.getIFrameDesignDimensions()}m=c(l.width,l.height,q)}if(m&&m.width&&m.height){this.changeParentTBSize(m.width,m.height);g(p,n);b.updateStageSize(m.width,m.height)}};this.resize=function(o,l,m,n){a.call(this,o,l,m,n);b.move();if(window[fnNameSpace].dragdropManager!=null){window[fnNameSpace].dragdropManager.resize()}if(window[fnNameSpace].OverlayTextBox!=null){window[fnNameSpace].OverlayTextBox.resizeOverlayTextBox()}}};window[fnNameSpace].DOMHelper=function(){this.maxZIndexOnPage=0;this.showiFrameTimeOut=0;this.checkElementOnPageById=function(a){if(!document.getElementById(a)){return false}return true};this.checkElementOnPageByTag=function(a){if(!document.getElementsByTagName(a)[0]){return false}return true};this.checkElementOnPageByTagName=function(a){return this.checkElementOnPageByTag(a)};this.getElementsByTagName=function(a){if(!this.checkElementOnPageByTag(a)){return false}return document.getElementsByTagName(a)};this.getElement=function(a){if(!this.checkElementOnPageById(a)){return false}return document.getElementById(a)};this.removeElement=function(a){a.parentNode.removeChild(a)};this.removeElementById=function(b){var a=this.getElement(b);if(a){this.removeElement(a)}};this.hideElement=function(a){if(this.isElementVisible(a)){window[fnNameSpace].util.setStyleWithImportant(a,"display","none",true)}};this.showElement=function(a){if(!this.isElementVisible(a)){window[fnNameSpace].util.setStyleWithImportant(a,"display","block",true)}};this.hideiFrameWithOpacity=function(a){window[fnNameSpace].util.setStyleWithImportant(manager.currentToolbar.dom,"-webkit-transition","opacity "+a+"s ease",true);window[fnNameSpace].util.setStyleWithImportant(manager.currentToolbar.dom,"opacity","0",true);window[fnNameSpace].util.setStyleWithImportant(manager.currentToolbar.dom,"pointer-events","none",true)};this.showiFrameWithOpacity=function(a){if(manager.currentToolbar.initialOpacityReset===true){return}if(this.showiFrameTimeOut&&this.showiFrameTimeOut>1){window.clearTimeout(this.showiFrameTimeOut)}this.showiFrameTimeOut=window.setTimeout(function(){window[fnNameSpace].util.setStyleWithImportant(manager.currentToolbar.dom,"-webkit-transition","opacity "+a+"s ease",true);window[fnNameSpace].util.setStyleWithImportant(manager.currentToolbar.dom,"opacity",manager.currentToolbar.lastOpacity,true);window[fnNameSpace].util.setStyleWithImportant(manager.currentToolbar.dom,"pointer-events","all",true)},700)};this.isElementVisible=function(a){return(a.style.display!=="none")};this.getMaxZIndex=function(e){var a=this.getElementsByTagName("*");var d=0;for(var c=0,f=a.length;c<f;c++){var b=Number(a[c].style.zIndex);var g=Number(window[fnNameSpace].displayUtils.getComputedStyle(a[c],"zIndex"));if(g>b){b=g}if(b>d){d=b}}this.maxZIndexOnPage=d;return d};this.appendChildToHead=function(b){var a=document.getElementsByTagName("head")[0];if(a=="undefined"){return false}a.appendChild(b);return true}};window[fnNameSpace].domHelper=new window[fnNameSpace].DOMHelper();window[fnNameSpace].Util=function(){this.useSerialization=true;this.TOOLBAR_DATA_TAG="TBData";this.TOOLBAR_DATA_ITEM_TAG="TBDataItem";this.TOOLBAR_DATA_ATTRIBUTE="toolbardata";this.NAME_ATTRIBUTE="name";this.VALUE_ATTRIBUTE="value";this.FN_TOOLBAR_SCRIPT="fn_toolbar_script";this.addEvent=function(event,func,capture,element){if((typeof event==="undefined")||(typeof func==="undefined")){return}if(typeof capture==="undefined"){capture=false}if(typeof element==="undefined"){element=document}if(element.addEventListener){element.addEventListener(event,func,capture)}else{if(element.attachEvent){element.attachEvent("on"+event,func)}else{element[event]=func}}};this.setStyleWithImportant=function(element,prop,value,important){if(element.style.setProperty){element.style.setProperty(prop,value,important?"important":"")}else{element.style[prop]=value}};this.removeEvent=function(event,func,capture,element){if((typeof event==="undefined")||(typeof func==="undefined")){return}if(typeof capture==="undefined"){capture=false}if(typeof element==="undefined"){element=document}if(element.removeEventListener){element.removeEventListener(event,func,capture)}else{if(element.detachEvent){element.detachEvent("on"+event,func)}else{element[event]=null}}};this.console=function(message,actionType){};this.serialize=function(obj){var t=typeof(obj);if(t!="object"||obj===null){if(t=="string"){obj='"'+obj+'"'}return String(obj)}else{var n,v,json=[],arr=(obj&&obj.constructor==Array);for(n in obj){v=obj[n];t=typeof(v);if(t=="string"){v='"'+v+'"'}else{if(t=="object"&&v!==null){v=JSON.stringify(v)}}json.push((arr?"":'"'+n+'":')+String(v))}return(arr?"[":"{")+String(json)+(arr?"]":"}")}};this.deserialize=function(jsonString){try{if(jsonString===""){jsonString='""'}eval("var object="+jsonString+";");return object}catch(ex){this.console("Deserialize error! on string: "+jsonString,"info");return}};this.registerLoadFunction=function(func){if(window.addEventListener){window.addEventListener("load",func,false)}else{if(window.attachEvent){window.attachEvent("onload",func)}else{var tmp1=window.onload;if(tmp1){window.onload=function(){func();tmp1()}}else{window.onload=func}}}};this.fetchGetVariableValue=function(variable){var query=window.location.search.substring(1);var vars=query.split("&");for(var i=0;i<vars.length;i++){var pair=vars[i].split("=");if(pair[0]==variable){return pair[1]}}return false};this.xmlToObject=function(string,rootTag,item,keyTag,valueTag){var parser;var response;try{parser=new DOMParser();response=parser.parseFromString(string,"text/xml");response=this.parseDataXML(response,rootTag,item,keyTag,valueTag);return response}catch(e){}};this.parseDataXML=function(xml,rootTag,item,keyTag,valueTag){var returnObj=new Object();var elem;var valuesArray;if(xml&&xml.firstChild){elem=xml.firstChild;if(xml.firstChild.target=="xml"){elem=xml.firstChild.nextSibling}if(elem.tagName==rootTag){if(elem.children){valuesArray=elem.children}else{valuesArray=elem.childNodes}}}if(valuesArray){window[fnNameSpace].util.console("---------------------------    parsing "+rootTag+" data xml. valuesArray="+valuesArray.length,"data")}else{window[fnNameSpace].util.console(" ---------------------------    parsing "+rootTag+" data xml. valuesArray="+valuesArray,"data")}if(valuesArray){for(var i=0;i<valuesArray.length;i++){if(valuesArray[i].tagName!=item){continue}var key=valuesArray[i].getAttribute(keyTag);var value=valuesArray[i].getAttribute(valueTag);returnObj[key]=unescape(value)}}return returnObj};this.getCookieData=function(cookieName){var cookiePrefix=cookieName+"=";var cookies=document.cookie.split(";");for(var i=0;i<cookies.length;i++){var c=cookies[i];while(c.charAt(0)==" "){c=c.substring(1,c.length)}var indx=c.indexOf(cookiePrefix);if(indx>=0){return c.substring(indx+cookiePrefix.length,c.length)}}return null};this.initXMLHttpClient=function(){var xmlhttp;try{xmlhttp=new XMLHttpRequest()}catch(e){var XMLHTTP_IDS=new Array("MSXML2.XMLHTTP.5.0","MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP");var success=false;for(var i=0;i<XMLHTTP_IDS.length&&!success;i++){try{xmlhttp=new ActiveXObject(XMLHTTP_IDS[i]);success=true}catch(e){}}if(!success){throw new Error("Unable to create XMLHttpRequest.")}}return xmlhttp};this.trim=function(string){return string.replace(/^\s*/,"").replace(/\s*$/,"")};this.thread=function(method){setTimeout(method,1)};this.isInteger=function(input){var pos=input.indexOf("px");if(pos!=-1){input=input.substr(0,pos-1)}return(input.toString().search(/^-?[0-9]+$/)==0)};this.loadScript=function(src,callback){var head=document.getElementsByTagName("head")[0];var script=document.createElement("script");script.type="text/javascript";var base=location.href.split("/");base.splice(-1,1);base=base.join("/");var scriptPath=base+src;script.src=scriptPath;script.onreadystatechange=function(){if(this.readyState=="complete"){callback()}};script.onload=callback;head.appendChild(script)};this.clone=function(obj){if(obj instanceof HTMLElement){return obj.cloneNode()}var target={};for(var i in obj){if(obj.hasOwnProperty(i)){if(typeof obj[i]=="object"){target[i]=this.clone(obj[i])}else{target[i]=obj[i]}}}return target};this.validateWidthHeight=function(widthOrHeight){if(!isNaN(parseInt(widthOrHeight))||(widthOrHeight==="auto")){return true}else{return false}};this.isNumberPixelBased=function(number){if(typeof number==="undefined"){return false}if(!isNaN(parseInt(number))&&(number.length>=2)&&number.substring(number.length-2)==="px"){return true}else{return false}};this.isNumberPercentageBased=function(number){if(typeof number==="undefined"){return false}if(!isNaN(parseInt(number))&&(number.length>=1)&&number.substring(number.length-1)==="%"){return true}else{return false}};this.Browser=(function(){var userAgent=navigator.userAgent.toLowerCase();var docMode=document.documentMode;var isOpera=check(/opera/);var isChrome=check(/\bchrome\b/);var isWebKit=check(/webkit/);var isSafari=!isChrome&&check(/safari/);var isIE=!isOpera&&check(/msie/);var isIE7=isIE&&(check(/msie 7/)||docMode===7);var isIE8=isIE&&(check(/msie 8/)&&docMode!=7);var isIE9=isIE&&check(/msie 9/);var isIE10=isIE&&check(/msie 10/);var isFirefox=!isWebKit&&check(/gecko/);var isFirefox3=isFirefox&&check(/rv:1\.9/);var isIOS=check(/iphone|ipad|ipod/);var isWindows=check(/windows/);var isWindows7=isWindows&&check(/windows nt 6.1/);var isWindows8=isWindows&&check(/windows nt 6.2/);var isAndroid=check(/android/);var isAndroid23=isAndroid&&check(/android 2\.3/);var isAndroid40=isAndroid&&check(/android 4\.0/);var isAndroid41=isAndroid&&check(/android 4\.1/);function check(re){return re.test(userAgent)}return{isOpera:isOpera,isChrome:isChrome,isWebKit:isWebKit,isSafari:isSafari,isIE:isIE,isIE7:isIE7,isIE8:isIE8,isIE9:isIE9,isIE10:isIE10,isFirefox:isFirefox,isFirefox3:isFirefox3,isIOS:isIOS,isWindows:isWindows,isWindows7:isWindows7,isWindows8:isWindows8,isAndroid:isAndroid,isAndroid23:isAndroid23,isAndroid40:isAndroid40,isAndroid41:isAndroid41}})()};window[fnNameSpace].util=new window[fnNameSpace].Util();window[fnNameSpace].DisplayUtils=function(){var c=function(){if(typeof window.orientation==="undefined"){return false}else{return(window.orientation===0)?true:false}};var g=function(j,k){var i=window.getComputedStyle(j,null)||{};return i[k]||j.style[k]};var a=function(){var i=window.getComputedStyle(document.body);var j=1;if(i&&i.zoom){j=i.zoom;if(window[fnNameSpace].util.isNumberPercentageBased(j)){j=parseFloat(j)/100}else{if(!isNaN(parseFloat(j))){j=parseFloat(j)}}}return j};var f=function(){var i=a();return{width:d("Width")/i,height:d("Height")/i}};var h=function(){var j=e();var k="portrait";if(!c()){k="landscape"}var i={};i.width=j[k].width+"px";i.height=j[k].height+"px";return i};var e=function(){var i=manager.currentToolbar.config;if(!i){throw"Util.getDeviceDetails() - configuration not set"}var k={};k.portrait={};k.landscape={};k.portrait.width=i.PortraitSize.Width;k.portrait.height=i.PortraitSize.Height;if(window[fnNameSpace].util.Browser.isIOS){var j=568;var l=480;if(window.screen.height===j){k.landscape.width=(j/l)*i.LandscapeSize.Width}else{k.landscape.width=i.LandscapeSize.Width}}else{k.landscape.width=i.LandscapeSize.Width}k.landscape.height=i.LandscapeSize.Height;return k};var b=function(){var l;try{var k=f();var i=h();l=((k.width/parseInt(i.width))*100)}catch(j){l=100}return l};var d=function(l){if(window[fnNameSpace].util.Browser.isAndroid23){return window["inner"+l]}else{if(window[fnNameSpace].util.Browser.isIOS){return window["inner"+l]}else{if(window[fnNameSpace].util.Browser.isAndroid){var k;k=window["inner"+l]!==0&&window["inner"+l];k=k||document.documentElement&&document.documentElement["client"+l]!==0&&document.documentElement["client"+l];k=k||document.body["client"+l];return k}else{var j=document.documentElement&&document.documentElement["client"+l]!==0&&document.documentElement["client"+l];if(window[fnNameSpace].util.Browser.isIE){return j||document.documentElement["offset"+l]}var k;var i=document.documentElement&&document.documentElement["scroll"+l]!==0&&document.documentElement["scroll"+l];if((i&&j)&&(i===j)){if(window[fnNameSpace].util.Browser.isFirefox){k=window["inner"+l]!==0&&window["inner"+l]}else{k=document.body["client"+l]}}k=k||j;k=k||window["inner"+l]!==0&&window["inner"+l];k=k||document.body["client"+l];return k}}}};return{isPortrait:c,getComputedStyle:g,getBodyZoomLevel:a,getVisualViewportInfo:f,getIFrameDesignDimensions:h,getIframeZoomLevel:b}};window[fnNameSpace].displayUtils=new window[fnNameSpace].DisplayUtils();if(window[fnNameSpace].displayUtils){window[fnNameSpace].displayUtils.getIframeZoomLevel=function(){return 100}}window[fnNameSpace].Message=function(){this.assignedObject;this.assignTo=function(b){this.assignedObject=b;window[fnNameSpace].util.addEvent("message",function(c){window[fnNameSpace].message.handleMessage(c)},false,window);window[fnNameSpace].util.console("Message handler assigned")};this.send=function(c,b){if(!b){return false}if((typeof(window[fnNameSpace].Manager)!="undefined")&&((b.tagName=="IFRAME"||b.tagName=="iframe"))){b=b.contentWindow}else{if(b!=parent){return false}}c.messageKey=fnMessageKey;if(window[fnNameSpace].util.useSerialization){c=window[fnNameSpace].util.serialize(c)}b.postMessage(c,"*");return true};var a=function(b){if(typeof b=="undefined"){return false}if(typeof b=="object"){if(typeof b.messageKey!="string"){return false}if(b.messageKey!=fnMessageKey){return false}}else{if(typeof b=="string"){if(typeof b.search!="function"){return false}if(b.search(fnMessageKey)==-1){return false}if(b.search("message")==-1){return false}if(b.search("function")!=-1){return false}}else{return false}}return true};this.triggerMessageEvent=function(c){var b;window[fnNameSpace].util.console("Sending message: "+window[fnNameSpace].util.serialize(c),"messaging");if(!window[fnNameSpace].message.assignedObject){window[fnNameSpace].util.console("Unable to send message message.message. no object assigned. ","messaging");return}b="on"+c.message;var d=typeof window[fnNameSpace].message.assignedObject[b];if(d!=="function"){window[fnNameSpace].util.console("called event "+b+" was not found","messaging");return}window[fnNameSpace].message.assignedObject[b](c)};this.handleMessage=function(c){var b=c.data;if(!a(b)){window[fnNameSpace].util.console("Invalid message rejected! "+window[fnNameSpace].util.serialize(b),"messaging");return false}if(typeof(b)!="object"){b=window[fnNameSpace].util.deserialize(b)}window[fnNameSpace].message.triggerMessageEvent(b)}};window[fnNameSpace].message=new window[fnNameSpace].Message();var fnMessageKey="FNMESSAGEKEY78dh782ijhk8abn2";window[fnNameSpace].Message.MessageQueue=function(){var a=100;var c=true;var b=[];this.removeOldMessages=true;this.add=function(d){while(b.length>=a){if(this.removeOldMessages){this.shift()}else{return}}c=false;b.push(d)};this.shift=function(){if(c){return false}var d=b.shift();if((!d)||(d==null)){c=true;return false}return d};this.setMaxQueuedMessages=function(d){if(parseInt(d)!=d){throw"Cant set new max queued messages, excepting integer. sent value: "+d}if(a===d){return}a=d;while(a<b.length){this.shift()}}};window[fnNameSpace].ViewPort=function(c){var j;var g=this;var d=function(l){l=l||{};j=l.metaObject;if(j){f(j)}else{k(l)}};var e=function(){var l=window[fnNameSpace].ViewPort.VIEWPORT_PROPERTIES;for(var m in l){var n=b(m);g[n]=l[m]}};var k=function(m){var l="";for(var n in m){if((typeof m[n]!="function")&&(typeof n!="undefined")&&(n.length>="content".length)&&(n.substring(0,"content".length)=="content")&&(typeof m[n]!="undefined")){if(l.length){l=l+", "}l=l+h(n)+"="+m[n]}}g.setMetaObj(l)};var a=function(){var l=document.createElement("meta");l.name="viewport";l.content="";l.id="FNViewport";return l};var f=function(m){var l=m.content;var n=l.split(",");if(n.length==1){n=n[0].split(";")}e();for(var o=0;o<n.length;o++){i(n[o])}};var i=function(l){l=l.toLowerCase();l=l.replace(/^\s+|\s+$/g,"");var m=l.split("=");var n=b(m[0]);if(n){g[n]=m[1]}else{window[fnNameSpace].util.console("Could not read VP variable: "+m[0]+" value:"+m[1])}};var b=function(m){m=window[fnNameSpace].util.trim(m);switch(m){case"width":case"height":return"content"+m.substr(0,1).toUpperCase()+m.substr(1);break;case"initial-scale":case"minimum-scale":case"maximum-scale":case"user-scalable":var l=m.split("-");l[0]=l[0].substr(0,1).toUpperCase()+l[0].substr(1);l[1]=l[1].substr(0,1).toUpperCase()+l[1].substr(1);return"content"+l[0]+l[1];break;default:window[fnNameSpace].util.console("Could not read VP variable: "+m);break}};var h=function(n){var m=n.match(/[A-Z][a-z]*/g);var o="";for(var l=0;l<m.length;l++){if(o.length){o+="-"}o+=m[l].substr(0,1).toLowerCase()+m[l].substr(1)}window[fnNameSpace].util.console(n+" converted to : "+o);return o};this.getMetaObj=function(){return j};this.setMetaObj=function(l){if(!j){j=a()}if(typeof l==="string"){j.content=l}else{j.content=l.content}f(j)};this.updateMetaObj=function(l){k(l)};this.update=function(m){var l=m.getMetaObj();this.setMetaObj(l)};this.clone=function(){var l={metaObject:this.getMetaObj().cloneNode()};var m=new window[fnNameSpace].ViewPort(l);return m};d(c);return this};window[fnNameSpace].ViewPort.isMobileAwareSite=function(){var c=window[fnNameSpace].ViewPort.getViewports();var a;var d;for(var b=0;b<c.length;b++){a=c[b];d=a.getMetaObj();if((d.content.toLowerCase().indexOf("minimum-scale=1")!=-1)||(d.content.toLowerCase().indexOf("maximum-scale=1")!=-1)||(d.content.toLowerCase().indexOf("user-scalable=no")!=-1)||(d.content.toLowerCase().indexOf("width=device-width")!=-1)){return true}}return false};window[fnNameSpace].ViewPort.getViewports=function(){var b=new Array();if(!window[fnNameSpace].domHelper.checkElementOnPageByTagName("META")){return b}var a=window[fnNameSpace].domHelper.getElementsByTagName("META");for(var c=0;c<a.length;c++){if(a[c].name.toLowerCase()=="viewport"){b.push(new window[fnNameSpace].ViewPort({metaObject:a[c]}))}}if(b){return b}};window[fnNameSpace].ViewPort.disableUserScalable=function(){if(window[fnNameSpace].ViewPort.isMobileAwareSite()){return}window[fnNameSpace].ViewPort.originalViewPortContent=null;var c=document.getElementsByTagName("meta");var e=-1;while(c[++e]){if(c[e].name==="viewport"){var d=c[e].content;if(d.search("user-scalable=no")!==-1){return}else{var b=d.search("user-scalable=yes");if(b!==-1){d=d.replace("user-scalable=yes","user-scalable=no")}else{d="user-scalable=no, "+d}}window[fnNameSpace].ViewPort.originalViewPortContent=c[e].content;c[e].content=d;return}}var a=document.createElement("meta");a.id=fnNameSpace+"_ViewPortMetaTagId";a.name="viewport";a.content="user-scalable=no";document.head.appendChild(a)};window[fnNameSpace].ViewPort.restoreUserScalable=function(){if(window[fnNameSpace].ViewPort.originalViewPortContent){var b=document.getElementsByTagName("meta");var c=-1;while(b[++c]){if(b[c].name==="viewport"){b[c].content="user-scalable=yes";b[c].content=window[fnNameSpace].ViewPort.originalViewPortContent;window[fnNameSpace].ViewPort.originalViewPortContent=null;return}}}else{var a=document.getElementById(fnNameSpace+"_ViewPortMetaTagId");if(a!==null){a.content="user-scalable=yes";document.head.removeChild(a)}}};window[fnNameSpace].ViewPort.createDefaultViewport=function(){};window[fnNameSpace].ViewPort.VIEWPORT_PROPERTIES={width:"",height:"","initial-scale":"","minimum-scale":"","maximum-scale":"","user-scalable":""};window[fnNameSpace].StopWatchManager=function(){this.watches=[];this.startNew=function(b,f,e,d){var c;if((!b)||(!f)){return false}if(!e){e=""}if(d){c=window.setTimeout(b,f)}else{c=window.setInterval(b,f)}var a=(this.watches.length!=false)?this.watches.length:1;this.watches[a]=[];this.watches[a].watchId=c;this.watches[a].tickTime=f;this.watches[a].comment=e;this.watches[a].tickOnce=d;this.watches[a].methodToExecute=b;this.watches[a].frozen=false;return a};this.getRealWatchId=function(a){return this.watches[a].watchId};this.start=function(b){if(this.watches[b].frozen==false){return}var a=this.watches[b];this.remove(b);return this.startNew(a.methodToExecute,a.tickTime,a.comment,a.tickOnce)};this.stop=function(a){this.watches[a].frozen=true;clearInterval(this.getRealWatchId(a))};this.remove=function(a){this.stop(a);delete this.watches[a]}};window[fnNameSpace].stopWatchMgr=new window[fnNameSpace].StopWatchManager();window[fnNameSpace].StopWatch=function(){this.watchId=null;this.isRunning=false;this.tickMethod=null;this.create=function(a,e,d,c){var b=null;b=window[fnNameSpace].stopWatchMgr.startNew(a,e,d,c);if(b){this.watchId=b;this.isRunning=true;this.tickMethod=a;return true}return false};this.tick=function(){this.tickMethod()};this.start=function(){if(this.isRunning){return}this.watchId=window[fnNameSpace].stopWatchMgr.start(this.watchId);this.isRunning=true};this.stop=function(){window[fnNameSpace].stopWatchMgr.stop(this.watchId);this.isRunning=false};this.remove=function(){window[fnNameSpace].stopWatchMgr.remove(this.watchId);this.isRunning=false}};window[fnNameSpace].FlashPlayerManager=function(){this.modifyFlashPlayerWmode=function(){if(window[fnNameSpace].util.Browser.isIE){this._changeWmodeOnYoutube()}else{if(window[fnNameSpace].util.Browser.isFirefox||window[fnNameSpace].util.Browser.isFirefox3||window[fnNameSpace].util.Browser.isSafari||window[fnNameSpace].util.Browser.isOpera){this._changeWmodeOn("embed");this._changeObjectType("application/x-silverlight","windowless","true")}else{if(window[fnNameSpace].util.Browser.isChrome){this._changeObjectType("application/x-silverlight","windowless","true")}}}};this._changeWmodeOnYoutube=function(){try{if(!document){return false}var b=document.getElementsByTagName("object");if(!b){return false}if(location.host.search("youtube")<0){return false}for(var h=0;h<b.length;h++){var g=b[h];var a=location.href.split("?")[0].replace(/watch/,"embed/");var d=location.href.split("?")[1].split("&");for(var h=0;h<d.length;h++){if(d[h].split("v=").length>1){a+=d[h].split("v=")[1];d.splice(h,1);break}}d.push("wmode=opaque");a+="?"+d.join("&");var l=g.clientHeight;var c=g.clientWidth;var k=g.parentElement;k.removeChild(k.firstChild);var f=document.createElement("iframe");f.setAttribute("src",a);f.setAttribute("height",l);f.setAttribute("width",c);k.appendChild(f)}}catch(j){return false}return true};this._changeWmodeOn=function(c){try{if(!document){return false}var b=document.getElementsByTagName(c);if(!b){return false}for(var a=0;a<b.length;a++){if((b[a].getAttribute("wmode")==null)||(b[a].getAttribute("wmode").toLowerCase()=="window")){b[a].setAttribute("wmode","opaque");if(b[a].outerHTML){b[a].outerHTML=b[a].outerHTML}}}}catch(d){return false}return true};this._changeObjectType=function(m,g,b){try{if(!document){return false}var n=document.getElementsByTagName("object");if(!n){return false}for(var f=0;f<n.length;f++){if(n[f].type.search(m)<0){continue}var k=n[f].getElementsByTagName("param");var d=false;if(k){for(var c=0;c<k.length;c++){var h=k[c].getAttribute("name");if(h&&h.toLowerCase()==g){k[c].setAttribute("value",b);d=true;break}}if(!d){var a=document.createElement("param");a.setAttribute("name",g);a.setAttribute("value",b);n[f].appendChild(a)}n[f].outerHTML=n[f].outerHTML}}}catch(l){return false}return true}};window[fnNameSpace].DragDropManager=function(a){this._isDragged=false;this._isDropped=false;this._lastEnableDragStateReq=false;this._dragIcon=null;this._params=a;this._isSuspend=false;this.restoreInitialIframePositioning=function(){var b=manager.currentToolbar;var c=this._params;b.setIframePositioning(c.initTop,c.initBottom,c.initLeft,c.initRight)};this._enableDragState=function(b){if(this._params.dragToolbarPosition==="fixed"){return}if(!manager){return}var c=manager.currentToolbar.dom;if(c){if(b||b===null){this._lastEnableDragStateReq=true;manager.loadToolbarPosition()}else{this._lastEnableDragStateReq=false;this.showDragDiv(false);this.restoreInitialIframePositioning()}}};this.enableDragState=this._enableDragState;this.registerDragSupport=function(){window[fnNameSpace].util.console("Toolbar registration for Drag and Drop.");try{var d=manager.currentToolbar.dom;if(this._params.dragToolbarPosition=="fixed"){this.restoreInitialIframePositioning();return}var l=document.createElement("div");l.setAttribute("id","dragDiv");l.setAttribute("draggable","true");window[fnNameSpace].util.setStyleWithImportant(l,"display","none",true);window[fnNameSpace].util.setStyleWithImportant(l,"position","fixed",true);window[fnNameSpace].util.setStyleWithImportant(l,"cursor","move",true);window[fnNameSpace].util.setStyleWithImportant(l,"opacity","0",true);window[fnNameSpace].util.setStyleWithImportant(l,"width","",true);window[fnNameSpace].util.setStyleWithImportant(l,"height","",true);window[fnNameSpace].util.setStyleWithImportant(l,"z-index",parseInt(d.style.zIndex)+1,true);document.body.appendChild(l);var k=this;this.addEvent(l,"mouseup",function(e){var i=window[fnNameSpace].util.Browser.isIE8;if((i&&(e.button===1))||(!i&&(e.button===0))){if(k._isMaximized==true){manager.minimizeToolbarRequest()}else{manager.maximizeToolbarRequest()}}else{return false}});this.addEvent(l,"mouseover",function(e){if(manager){manager.attachClassToElement("fnToolbarMinimized","fnToolbarMinimized_over_on_animation")}});this.addEvent(l,"mouseout",function(e){if(manager){manager.attachClassToElement("fnToolbarMinimized","fnToolbarMinimized_over_off_animation")}});if(document.attachEvent){var j=document.createElement("img");j.setAttribute("id","dragImg");j.setAttribute("draggable","true");j.setAttribute("src",this._params.dragTransparentIconSrc);j.setAttribute("height","100%");j.setAttribute("width","100%");l.setAttribute("draggable","false");l.appendChild(j)}var g=document.createElement("div");g.setAttribute("id","dropBackground");window[fnNameSpace].util.setStyleWithImportant(g,"position","fixed",true);window[fnNameSpace].util.setStyleWithImportant(g,"z-index",parseInt(d.style.zIndex)-1,true);window[fnNameSpace].util.setStyleWithImportant(g,"left","0px",true);window[fnNameSpace].util.setStyleWithImportant(g,"top","0px",true);window[fnNameSpace].util.setStyleWithImportant(g,"margin","0px",true);window[fnNameSpace].util.setStyleWithImportant(g,"padding","0px",true);this.hideDropArea();document.body.appendChild(g);this.setDragIcon(this._params.dragIconSrc);var b=((window[fnNameSpace].util.Browser.isWindows&&window[fnNameSpace].util.Browser.isSafari)||(window[fnNameSpace].util.Browser.isWindows8&&window[fnNameSpace].util.Browser.isIE10));var c=document.querySelectorAll("[draggable=true]");for(var f=0;f<c.length;f++){this.addEvent(c[f],"dragstart",function(e){k._isDragged=true;k._isDropped=false;e.dataTransfer.setData("Text",k._params.dropOnAddressUrl);e.dataTransfer.effectAllowed="move";if(e.dataTransfer.setDragImage){var m=parseInt(l.style.width)/2;var i=parseInt(l.style.height)/2;e.dataTransfer.setDragImage(k._dragIcon,m,i)}window[fnNameSpace].util.setStyleWithImportant(g,"width","100%",true);window[fnNameSpace].util.setStyleWithImportant(g,"height","100%",true);window[fnNameSpace].util.setStyleWithImportant(g,"display","block",true);setTimeout(k.hideDropArea,10000)});this.addEvent(c[f],"dragend",function(m){k._isDropped=false;if(b){if(k._params.dragToolbarPosition=="all"){k.hideDropArea();var i=window[fnNameSpace].displayUtils.getVisualViewportInfo();var e=m.pageX<41?21:(m.pageX>(i.width-4)?(i.width-24):m.pageX-21);var n=m.pageY<41?21:(m.pageY>(i.height-4)?(i.height-26):m.pageY-21);k.autoPositioning(e,n,k._params.dragToolbarPosition)}else{_drop(m)}}if(!k._isDropped){setTimeout(k.hideDropArea,100)}})}_preventDefault=function(e){if(e.stopPropagation){e.stopPropagation()}if(e.preventDefault){e.preventDefault()}};_drop=function(e){_preventDefault(e);k._isDropped=true;k.hideDropArea();k.autoPositioning(e.clientX,e.clientY,k._params.dragToolbarPosition)};_allowDrop=function(i){_preventDefault(i);try{i.returnValue=false}catch(m){}i.dataTransfer.dropEffect="move";return false};this.addEvent(g,"dragover",_allowDrop);this.addEvent(g,"dragenter",_allowDrop);if(b){return}this.addEvent(g,"drop",_drop)}catch(h){}};this.suspendDragDrop=function(b){this._isSuspend=b;if(b){this.showDragDiv(false);this.restoreInitialIframePositioning();this.enableDragState=function(c){this._lastEnableDragStateReq=(c||c==null)?true:false}}else{this.enableDragState=this._enableDragState;this.enableDragState(this._lastEnableDragStateReq)}};this.showDragDiv=function(b){var c=document.getElementById("dragDiv");if(!c){return}if(b){window[fnNameSpace].util.setStyleWithImportant(c,"display","block",true);window[fnNameSpace].util.setStyleWithImportant(c,"visibility","",true);window[fnNameSpace].util.setStyleWithImportant(c,"z-index",parseInt(manager.currentToolbar.dom.style.zIndex)+1,true)}else{window[fnNameSpace].util.setStyleWithImportant(c,"display","none",true);window[fnNameSpace].util.setStyleWithImportant(c,"visibility","hidden",true);window[fnNameSpace].util.setStyleWithImportant(c,"z-index","0",true)}};this.isSuspend=function(){return this._isSuspend};this.setPosition=function(e,h){var d=manager.currentToolbar.dom;var g="";var b="";var c="";var i="";manager.currentToolbar.setIframePositioning(g,b,c,i);var f=window[fnNameSpace].displayUtils.getVisualViewportInfo();var j=f.height/2;if(e=="TB_VERTICAL_POSITION_TOP"){g=this._params.verticalMargin}else{if(e=="TB_VERTICAL_POSITION_MIDDLE"){b=j+"px"}else{if(e=="TB_VERTICAL_POSITION_BOTTOM"){b=this._params.verticalMargin}else{if(e&&e.length>0){g=e}else{b=this._params.initBottom;g=this._params.initTop}}}}if(h=="TB_HORIZONTAL_POSITION_LEFT"){c=this._params.horizontalMargin}else{if(h=="TB_HORIZONTAL_POSITION_RIGHT"){i=this._params.horizontalMargin}else{if(h&&h.length>0){c=h}else{i=this._params.initRight;c=this._params.initLeft}}}manager.currentToolbar.setIframePositioning(g,b,c,i);var k=document.getElementById("dragDiv");window[fnNameSpace].util.setStyleWithImportant(k,"left",d.style.left,true);window[fnNameSpace].util.setStyleWithImportant(k,"top",d.style.top,true);window[fnNameSpace].util.setStyleWithImportant(k,"bottom",d.style.bottom,true);window[fnNameSpace].util.setStyleWithImportant(k,"right",d.style.right,true);window[fnNameSpace].util.setStyleWithImportant(k,"display","block",true);this.showDragDiv(true)};this.setDragIcon=function(b){if(this._dragIcon==null){this._dragIcon=document.createElement("img")}this._dragIcon.src=b};this.toolbarStateChanged=function(c){try{if(c==="minimized"){this._isMaximized=false;this.enableDragState(this._params.allowDragMinimize)}else{if(c==="maximized"){this._isMaximized=true;this.enableDragState(this._params.allowDragMaximize)}}}catch(b){}};this.resize=function(){var b=document.getElementById("dragDiv");if(b){window[fnNameSpace].util.setStyleWithImportant(b,"width",manager.currentToolbar.dom.style.width,true);window[fnNameSpace].util.setStyleWithImportant(b,"height",manager.currentToolbar.dom.style.height,true)}};this.autoPositioning=function(l,j,i){var f=manager.currentToolbar.dom;var k="";var b="";var c="";var m="";manager.currentToolbar.setIframePositioning(k,b,c,m);window[fnNameSpace].util.setStyleWithImportant(f,"position","fixed",true);var h="TB_HORIZONTAL_POSITION_RIGHT";var q="TB_VERTICAL_POSITION_BOTTOM";var e=parseInt(f.style.width)/2;var d=parseInt(f.style.height)/2;var g=window[fnNameSpace].displayUtils.getVisualViewportInfo();var p=g.width/2;var n=g.height/2;switch(i){case"four":if(l<p){c=this._params.horizontalMargin;h="TB_HORIZONTAL_POSITION_LEFT"}else{m=this._params.horizontalMargin;h="TB_HORIZONTAL_POSITION_RIGHT"}if(j<n){k=this._params.verticalMargin;q="TB_VERTICAL_POSITION_TOP"}else{b=this._params.verticalMargin;q="TB_VERTICAL_POSITION_BOTTOM"}manager.currentToolbar.setIframePositioning(k,b,c,m);break;case"six":screenThirdY=g.height/3;if(l<p){c=this._params.horizontalMargin;h="TB_HORIZONTAL_POSITION_LEFT"}else{m=this._params.horizontalMargin;h="TB_HORIZONTAL_POSITION_RIGHT"}if(j<screenThirdY){k=this._params.verticalMargin;q="TB_VERTICAL_POSITION_TOP"}else{if((j>screenThirdY)&&j<(2*screenThirdY)){b=n+"px";q="TB_VERTICAL_POSITION_MIDDLE"}else{b=this._params.verticalMargin;q="TB_VERTICAL_POSITION_BOTTOM"}}manager.currentToolbar.setIframePositioning(k,b,c,m);break;default:h=f.style.left=(l-e)+"px";q=f.style.top=(j-d)+"px";break}var o=document.getElementById("dragDiv");window[fnNameSpace].util.setStyleWithImportant(o,"left",f.style.left,true);window[fnNameSpace].util.setStyleWithImportant(o,"top",f.style.top,true);window[fnNameSpace].util.setStyleWithImportant(o,"bottom",f.style.bottom,true);window[fnNameSpace].util.setStyleWithImportant(o,"right",f.style.right,true);this.saveLastPosition(q,h)};this.saveLastPosition=function(b,c){if(manager){manager.storeToolbarPosition(b,c)}};this.hideDropArea=function(){_isDragged=false;var b=document.getElementById("dropBackground");if(b){window[fnNameSpace].util.setStyleWithImportant(b,"display","none",true);window[fnNameSpace].util.setStyleWithImportant(b,"width","0px",true);window[fnNameSpace].util.setStyleWithImportant(b,"height","0px",true)}};this.addEvent=(function(){if(document.addEventListener){return function(e,d,c){if(e&&e.nodeName||e===window){e.addEventListener(d,c,false)}else{if(e&&e.length){for(var b=0;b<e.length;b++){addEvent(e[b],d,c)}}}}}else{return function(e,d,c){if(e&&e.nodeName||e===window){e.attachEvent("on"+d,function(){return c.call(e,window.event)})}else{if(e&&e.length){for(var b=0;b<e.length;b++){addEvent(e[b],d,c)}}}}}})()};var manager=new window[fnNameSpace].Manager();window.onload=function(a){window[fnNameSpace].uiEventHandler.loadEvent(a)};var intrvl=null;var numberOfRetries=50;var checkWhenLoadedDone=function(){if(intrvl==null){return}if(document.readyState=="complete"||numberOfRetries==0){window.setTimeout(function(){manager.initManager()},1000)}else{intrvl=window.setTimeout(checkWhenLoadedDone,500)}numberOfRetries--};if(document.readyState=="complete"){window.setTimeout(function(){manager.initManager()},1000)}else{if(document.readyState=="loaded"||document.readyState=="interactive"){if(intrvl==null){intrvl=window.setTimeout(checkWhenLoadedDone,500)}}else{window[fnNameSpace].util.registerLoadFunction(function(){window.setTimeout(function(){manager.initManager()},1000)})}};